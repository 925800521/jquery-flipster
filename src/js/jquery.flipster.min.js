(function(a){a.fn.flipster=function(b){var e={itemContainer:"ul",itemSelector:"li",style:"coverflow",start:"center",enableKeyboard:true,enableMousewheel:true,enableTouch:true,enableNav:false,enableNavButtons:false,onItemSwitch:function(){},disableRotation:false};var c=a.extend({},e,b);var d=a(window);return this.each(function(){var u=a(this);var w;var h;var k;var r;var g=0;var o=0;var q=0;var l;var f;function m(){q=0;}function v(){w.css("height",h.height());u.css("height","auto");if(c.style==="carousel"){w.width(h.width());}}function p(){if(c.enableNav&&h.length>1){var z=[],B=[],A=[];h.each(function(){var E=a(this).data("flip-category"),F=a(this).attr("id"),D=a(this).attr("title");if(typeof E!=="undefined"){if(a.inArray(E,z)<0){z.push(E);A[E]='<li class="flip-nav-category"><a href="#" class="flip-nav-category-link" data-flip-category="'+E+'">'+E+'</a>\n<ul class="flip-nav-items">\n';}}if(a.inArray(F,B)<0){B.push(F);link='<a href="#'+F+'" class="flip-nav-item-link">'+D+"</a></li>\n";if(typeof E!=="undefined"){A[E]=A[E]+'<li class="flip-nav-item">'+link;}else{A[F]='<li class="flip-nav-item no-category">'+link;}}});navDisplay='<ul class="flipster-nav">\n';for(var y in z){A[z[y]]=A[z[y]]+"</ul>\n</li>\n";}for(var C in A){navDisplay+=A[C];}navDisplay+="</ul>";k=a(navDisplay).prependTo(u);r=k.find("a").on("click",function(E){var D;if(a(this).hasClass("flip-nav-category-link")){D=h.filter("[data-flip-category='"+a(this).data("flip-category")+"']");}else{D=a(this.hash);}if(D.length){j(D);E.preventDefault();}});}}function n(){if(c.enableNav&&h.length>1){currentItem=a(h[g]);k.find(".flip-nav-current").removeClass("flip-nav-current");r.filter("[href='#"+currentItem.attr("id")+"']").addClass("flip-nav-current");r.filter("[data-flip-category='"+currentItem.data("flip-category")+"']").parent().addClass("flip-nav-current");}}function t(){if(c.enableNavButtons&&h.length>1){u.find(".flipto-prev, .flipto-next").remove();u.append("<a href='#' class='flipto-prev'>Previous</a> <a href='#' class='flipto-next'>Next</a>");u.children(".flipto-prev").on("click",function(y){j("left");y.preventDefault();});u.children(".flipto-next").on("click",function(y){j("right");y.preventDefault();});}}function x(){var K=a(h[g]).addClass("flip-current");h.removeClass("flip-prev flip-next flip-current flip-past flip-future no-transition");if(c.style==="carousel"){h.addClass("flip-hidden");var y=a(h[g+1]),I=a(h[g+2]),J=a(h[g-1]),M=a(h[g-2]);if(g===0){J=h.last();M=J.prev();}else{if(g===1){M=h.last();}else{if(g===h.length-2){I=h.first();}else{if(g===h.length-1){y=h.first();I=a(h[1]);}}}}I.removeClass("flip-hidden").addClass("flip-future");M.removeClass("flip-hidden").addClass("flip-past");y.removeClass("flip-hidden").addClass("flip-next");J.removeClass("flip-hidden").addClass("flip-prev");}else{var H=K.outerWidth()/2;var A=0;var F=w.width();var C=K.outerWidth();var B=(h.index(K)*C)/2+H/2;h.removeClass("flip-hidden");for(i=0;i<h.length;i++){var z=a(h[i]);var G=z.outerWidth();if(i<g){z.addClass("flip-past").css({"z-index":i,left:(i*G/2)+"px"});}else{if(i>g){z.addClass("flip-future").css({"z-index":h.length-i,left:(i*G/2)+H+"px"});}}}K.css({"z-index":h.length+1,left:B+"px"});A=(B+(C/2))-(F/2);var E=-1*(A)+"px";if(f){var L=a(".flip-past");var D=a(".flip-future");a(".flip-current").css("zoom","1.0");for(i=0;i<L.length;i++){a(L[i]).css("zoom",(100-((L.length-i)*5)+"%"));}for(i=0;i<D.length;i++){a(D[i]).css("zoom",(100-((i+1)*5)+"%"));}w.animate({left:E},333);}else{w.css("left",E);}}K.addClass("flip-current").removeClass("flip-prev flip-next flip-past flip-future flip-hidden");v();n();c.onItemSwitch.call(this);}function j(y){if(h.length>1){if(y==="left"){if(g>0){g--;}else{g=h.length-1;}}else{if(y==="right"){if(g<h.length-1){g++;}else{g=0;}}else{if(typeof y==="number"){g=y;}else{g=h.index(y);}}}x();}}function s(){u.addClass("flipster flipster-active flipster-"+c.style).css("visibility","hidden");if(c.disableRotation){u.addClass("no-rotate");}w=u.find(c.itemContainer).addClass("flip-items");h=w.find(c.itemSelector).addClass("flip-item flip-hidden").wrapInner("<div class='flip-content' />");var A=("\v"==="v");var y=document.createElement("b");y.innerHTML="<!--[if IE 9]><i></i><![endif]-->";var z=y.getElementsByTagName("i").length===1;if(A||z){f=true;w.addClass("compatibility");}p();t();if(c.start&&h.length>1){if(c.start==="center"){if(!h.length%2){g=h.length/2+1;}else{g=Math.floor(h.length/2);}}else{g=c.start;}}v();u.hide().css("visibility","visible").fadeIn(400,function(){x();});d.resize(function(){v();x();});h.on("click",function(B){if(!a(this).hasClass("flip-current")){B.preventDefault();}j(h.index(this));});if(c.enableKeyboard&&h.length>1){d.on("keydown.flipster",function(C){q++;if(q%7!==0&&q!==1){return;}var B=C.which;if(B===37){C.preventDefault();j("left");}else{if(B===39){C.preventDefault();j("right");}}});d.on("keyup.flipster",function(B){q=0;});}if(c.enableMousewheel&&h.length>1){u.on("mousewheel.flipster",function(B){l=window.setTimeout(m,500);q++;if(q%4!==0&&q!==1){return;}window.clearTimeout(l);if(B.originalEvent.wheelDelta/120>0){j("left");}else{j("right");}B.preventDefault();});}if(c.enableTouch&&h.length>1){u.on("touchstart.flipster",function(B){o=B.originalEvent.targetTouches[0].screenX;});u.on("touchmove.flipster",function(D){D.preventDefault();var B=D.originalEvent.targetTouches[0].screenX;var C=B-o;if(C>h[0].clientWidth/1.75){j("left");o=B;}else{if(C<-1*(h[0].clientWidth/1.75)){j("right");o=B;}}});u.on("touchend.flipster",function(B){o=0;});}}if(!u.hasClass("flipster-active")){s();}});};})(jQuery);